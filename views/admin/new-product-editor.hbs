<div class="main-wrapper">
    <div class="app" id="app">
        <div class="sidebar-overlay" id="sidebar-overlay"></div>
        <div class="sidebar-mobile-menu-handle" id="sidebar-mobile-menu-handle"></div>
        <div class="mobile-menu-handle"></div>
        <article class="content item-editor-page">
            <div class="title-block">
                <h3 class="title"> Chỉnh sửa sản phẩm
                    <span class="sparkline bar" data-type="bar"></span>
                </h3>
            </div>
            <!--<form name="item" method="post">-->
                <div class="card card-block">
                    <div class="form-group row">
                        <label class="col-sm-2 form-control-label text-xs-right"> Tiêu đề: </label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control boxed" id="title" placeholder="" value="{{list.title}}"> </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-sm-2 form-control-label text-xs-right"> Content: </label>
                        <div class="col-sm-10">
                            <div class="wyswyg">
                                <div class="toolbar">
                                    <select class="ql-size">
                                        <option value="small"></option>
                                        <option selected></option>
                                        <option value="large"></option>
                                        <option value="huge"></option>
                                    </select>
                                    <button class="ql-bold"></button>
                                    <button class="ql-italic"></button>
                                    <button class="ql-underline"></button>
                                    <button class="ql-strike"></button>
                                    <select title="Text Color" class="ql-color">
                                        <option value="rgb(0, 0, 0)" label="rgb(0, 0, 0)" selected></option>
                                        <option value="rgb(230, 0, 0)" label="rgb(230, 0, 0)"></option>
                                        <option value="rgb(255, 153, 0)" label="rgb(255, 153, 0)"></option>
                                        <option value="rgb(255, 255, 0)" label="rgb(255, 255, 0)"></option>
                                        <option value="rgb(0, 138, 0)" label="rgb(0, 138, 0)"></option>
                                        <option value="rgb(0, 102, 204)" label="rgb(0, 102, 204)"></option>
                                        <option value="rgb(153, 51, 255)" label="rgb(153, 51, 255)"></option>
                                        <option value="rgb(255, 255, 255)" label="rgb(255, 255, 255)"></option>
                                        <option value="rgb(250, 204, 204)" label="rgb(250, 204, 204)"></option>
                                        <option value="rgb(255, 235, 204)" label="rgb(255, 235, 204)"></option>
                                        <option value="rgb(255, 255, 204)" label="rgb(255, 255, 204)"></option>
                                        <option value="rgb(204, 232, 204)" label="rgb(204, 232, 204)"></option>
                                        <option value="rgb(204, 224, 245)" label="rgb(204, 224, 245)"></option>
                                        <option value="rgb(235, 214, 255)" label="rgb(235, 214, 255)"></option>
                                        <option value="rgb(187, 187, 187)" label="rgb(187, 187, 187)"></option>
                                        <option value="rgb(240, 102, 102)" label="rgb(240, 102, 102)"></option>
                                        <option value="rgb(255, 194, 102)" label="rgb(255, 194, 102)"></option>
                                        <option value="rgb(255, 255, 102)" label="rgb(255, 255, 102)"></option>
                                        <option value="rgb(102, 185, 102)" label="rgb(102, 185, 102)"></option>
                                        <option value="rgb(102, 163, 224)" label="rgb(102, 163, 224)"></option>
                                        <option value="rgb(194, 133, 255)" label="rgb(194, 133, 255)"></option>
                                        <option value="rgb(136, 136, 136)" label="rgb(136, 136, 136)"></option>
                                        <option value="rgb(161, 0, 0)" label="rgb(161, 0, 0)"></option>
                                        <option value="rgb(178, 107, 0)" label="rgb(178, 107, 0)"></option>
                                        <option value="rgb(178, 178, 0)" label="rgb(178, 178, 0)"></option>
                                        <option value="rgb(0, 97, 0)" label="rgb(0, 97, 0)"></option>
                                        <option value="rgb(0, 71, 178)" label="rgb(0, 71, 178)"></option>
                                        <option value="rgb(107, 36, 178)" label="rgb(107, 36, 178)"></option>
                                        <option value="rgb(68, 68, 68)" label="rgb(68, 68, 68)"></option>
                                        <option value="rgb(92, 0, 0)" label="rgb(92, 0, 0)"></option>
                                        <option value="rgb(102, 61, 0)" label="rgb(102, 61, 0)"></option>
                                        <option value="rgb(102, 102, 0)" label="rgb(102, 102, 0)"></option>
                                        <option value="rgb(0, 55, 0)" label="rgb(0, 55, 0)"></option>
                                        <option value="rgb(0, 41, 102)" label="rgb(0, 41, 102)"></option>
                                        <option value="rgb(61, 20, 102)" label="rgb(61, 20, 102)"></option>
                                    </select>
                                    <select title="Background Color" class="ql-background">
                                        <option value="rgb(0, 0, 0)" label="rgb(0, 0, 0)"></option>
                                        <option value="rgb(230, 0, 0)" label="rgb(230, 0, 0)"></option>
                                        <option value="rgb(255, 153, 0)" label="rgb(255, 153, 0)"></option>
                                        <option value="rgb(255, 255, 0)" label="rgb(255, 255, 0)"></option>
                                        <option value="rgb(0, 138, 0)" label="rgb(0, 138, 0)"></option>
                                        <option value="rgb(0, 102, 204)" label="rgb(0, 102, 204)"></option>
                                        <option value="rgb(153, 51, 255)" label="rgb(153, 51, 255)"></option>
                                        <option value="rgb(255, 255, 255)" label="rgb(255, 255, 255)" selected></option>
                                        <option value="rgb(250, 204, 204)" label="rgb(250, 204, 204)"></option>
                                        <option value="rgb(255, 235, 204)" label="rgb(255, 235, 204)"></option>
                                        <option value="rgb(255, 255, 204)" label="rgb(255, 255, 204)"></option>
                                        <option value="rgb(204, 232, 204)" label="rgb(204, 232, 204)"></option>
                                        <option value="rgb(204, 224, 245)" label="rgb(204, 224, 245)"></option>
                                        <option value="rgb(235, 214, 255)" label="rgb(235, 214, 255)"></option>
                                        <option value="rgb(187, 187, 187)" label="rgb(187, 187, 187)"></option>
                                        <option value="rgb(240, 102, 102)" label="rgb(240, 102, 102)"></option>
                                        <option value="rgb(255, 194, 102)" label="rgb(255, 194, 102)"></option>
                                        <option value="rgb(255, 255, 102)" label="rgb(255, 255, 102)"></option>
                                        <option value="rgb(102, 185, 102)" label="rgb(102, 185, 102)"></option>
                                        <option value="rgb(102, 163, 224)" label="rgb(102, 163, 224)"></option>
                                        <option value="rgb(194, 133, 255)" label="rgb(194, 133, 255)"></option>
                                        <option value="rgb(136, 136, 136)" label="rgb(136, 136, 136)"></option>
                                        <option value="rgb(161, 0, 0)" label="rgb(161, 0, 0)"></option>
                                        <option value="rgb(178, 107, 0)" label="rgb(178, 107, 0)"></option>
                                        <option value="rgb(178, 178, 0)" label="rgb(178, 178, 0)"></option>
                                        <option value="rgb(0, 97, 0)" label="rgb(0, 97, 0)"></option>
                                        <option value="rgb(0, 71, 178)" label="rgb(0, 71, 178)"></option>
                                        <option value="rgb(107, 36, 178)" label="rgb(107, 36, 178)"></option>
                                        <option value="rgb(68, 68, 68)" label="rgb(68, 68, 68)"></option>
                                        <option value="rgb(92, 0, 0)" label="rgb(92, 0, 0)"></option>
                                        <option value="rgb(102, 61, 0)" label="rgb(102, 61, 0)"></option>
                                        <option value="rgb(102, 102, 0)" label="rgb(102, 102, 0)"></option>
                                        <option value="rgb(0, 55, 0)" label="rgb(0, 55, 0)"></option>
                                        <option value="rgb(0, 41, 102)" label="rgb(0, 41, 102)"></option>
                                        <option value="rgb(61, 20, 102)" label="rgb(61, 20, 102)"></option>
                                    </select>
                                    <button class="ql-list" value="ordered"></button>
                                    <button class="ql-list" value="bullet"></button>
                                    <select title="Text Alignment" class="ql-align">
                                        <option selected></option>
                                        <option value="center" label="Center"></option>
                                        <option value="right" label="Right"></option>
                                        <option value="justify" label="Justify"></option>
                                    </select>
                                    <button class="ql-link"></button>
                                    <button style="width: auto;" type="button" title="Image" class="btn btn-secondary btn-sm" data-toggle="modal" data-target="#modal-media">
                                        <i class="fa fa-image"></i> Media </button>
                                </div>
                                <div class="editor" id="des">{{{list.des}}} </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-sm-2 form-control-label text-xs-right"> Quận: </label>
                        <div class="col-sm-10">
                            <select class="c-select form-control boxed" id="ward">
                                {{#each listward}}
                                    {{#if this.check}}
                                        <option selected>{{this.ward}}</option>
                                    {{else}}
                                        <option >{{this.ward}}</option>
                                    {{/if}}
                                {{/each}}
                            </select>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-sm-2 form-control-label text-xs-right"> Images: </label>
                        <div class="col-sm-10">
                            <div class="images-container">
                                <div class="image-container">
                                    <div class="controls">
                                        <a href="#" idclass="control-btn move">
                                            <i class="fa fa-arrows"></i>
                                        </a>

                                        <a href="#" class="add-image " id="addImage1" name="{{list.image1}}" data-toggle="modal" data-target="#modal-media">
                                            <i class="fa fa-plus" h></i>
                                        </a>

                                        <a href="#" id="reload2" class="control-btn remove" data-toggle="modal" data-target="#confirm-modal">
                                            <i class="fa fa-trash-o"></i>
                                        </a>
                                    </div>
                                    <div class="image" id="image1" style="background-image:url('{{list.image1}}')"></div>
                                </div>
                                <div class="image-container">
                                    <div class="controls">
                                        <a href="#" class="control-btn move">
                                            <i class="fa fa-arrows"></i>
                                        </a>
                                        <!--
                        -->
                                        <a href="#" class="add-image " id="addImage2" name="{{list.image2}}"data-toggle="modal" data-target="#modal-media">
                                            <i class="fa fa-plus" h></i>
                                        </a>
                                        <!--
                        -->
                                        <a href="#" id="reload2" class="control-btn remove" data-toggle="modal" data-target="#confirm-modal">
                                            <i class="fa fa-trash-o"></i>
                                        </a>
                                    </div>
                                    <div class="image" id="image2" style="background-image:url('{{list.image2}}')"></div>
                                </div>
                                <div class="image-container">
                                    <div class="controls">
                                        <a href="#" class="control-btn move">
                                            <i class="fa fa-arrows"></i>
                                        </a>
                                        <a href="#" class="add-image " id="addImage3" name="{{list.image3}}"data-toggle="modal" data-target="#modal-media">
                                            <i class="fa fa-plus" h></i>
                                        </a>
                                        <a href="#" id="reload2" class="control-btn remove" data-toggle="modal" data-target="#confirm-modal">
                                            <i class="fa fa-trash-o"></i>
                                        </a>
                                    </div>
                                    <div class="image" id="image3" style="background-image:url('{{list.image3}}')"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-sm-10 col-sm-offset-2">
                            <button type="submit" id="submitbtn22" class="btn btn-primary"> Xác nhận </button>
                        </div>
                    </div>
                </div>
            <!--</form>-->
        </article>
        <div class="modal fade" id="modal-media">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Media Library</h4>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                            <span class="sr-only">Close</span>
                        </button>
                    </div>
                    <div class="modal-body modal-tab-container">
                        <ul class="nav nav-tabs modal-tabs" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" href="#gallery" data-toggle="tab" role="tab">Gallery</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#upload" data-toggle="tab" role="tab">Upload</a>
                            </li>
                        </ul>
                        <form method="post"  enctype="multipart/form-data">
                        <div class="tab-content modal-tab-content">
                                <div class="tab-pane fade active in" id="upload" role="tabpanel">
                                    <div class="file-loading">
                                        <input id="input-700"  type="file" name="image" >
                                    </div>
                                </div>
                        </div>
                        </form>
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
        </div>
        <!-- /.modal -->
        <div class="modal fade" id="confirm-modal">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">
                            <i class="fa fa-pencil"></i>  &nbsp; Xác nhận cập nhật sản phẩm</h4>
                        <button type="button" id="close" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <p>Bạn có chắc chắn muốn cập nhật sản phẩm này?</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="submitUpdate" class="btn btn-primary" data-dismiss="modal">Yes</button>
                        <button type="button" id="no" class="btn btn-secondary" data-dismiss="modal">No</button>
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
        </div>
        <!-- /.modal -->
    </div>
</div>
<!-- Reference block for JS -->
<div class="ref" id="ref">
    <div class="color-primary"></div>
    <div class="chart">
        <div class="color-primary"></div>
        <div class="color-secondary"></div>
    </div>
</div>




<div class="modal fade" id="success-modal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">
                    <i class="fa fa-check"></i> &nbsp;Thông tin sản phẩm</h4>
                <button type="button" id="close" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>Đã cập nhật sản phẩm thành công !!</p>
            </div>
           <!-- <div class="modal-footer">
                <button type="button" id="submitUpdate" class="btn btn-primary" data-dismiss="modal">Yes</button>
                <button type="button" id="no" class="btn btn-secondary" data-dismiss="modal">No</button>
            </div>-->
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
{{#section 'cssAdmin'}}
    <!--<link href="https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-fileinput@5.2.5/css/fileinput.min.css" media="all" rel="stylesheet" type="text/css" />-->
{{/section}}
{{#section 'jsAdmin'}}
    <!--<script src="https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-fileinput@5.2.5/js/fileinput.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-fileinput/5.2.5/themes/fa/theme.min.js" integrity="sha512-ywJxJU8HX2ZyXikj/iM4gW2vWIhnGCjfehz9kMU0oqo0GDdr3w8E2E3DZlzgIBTNKU8jovkg09pWktiw0mOFeg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-fileinput/5.2.5/js/locales/vi.min.js" integrity="sha512-Uq/oCjgDVhP8yiVZWU3F+XZcIwdIeMCgP43VG/Q/V3rqlhdpLS16CRknPqjKo4WUUM606zVchpiJuIkMJbQp7w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>-->
    <script>
        $('#no').click(function (){
            $('#confirm-modal').modal('hide');

        })
        $('#close').click(function (){
            $('#confirm-modal').modal('hide');
        })
        $('#submitbtn22').click(function (){
            $('#confirm-modal').modal('show');
        });
        function myGreeting(){
            location.reload();
        }
        $('#submitUpdate').click(function (){
            var des=$('#des').html().replace('contenteditable="true"',"contenteditable=false");
            $.post("/admin/san-pham/du-an/sua-san-pham/{{list.proid}}",{title:$('#title').val(),des:des,ward:$("#ward option:selected").val(),check:true},function (data,status){
                if(data){
                    $('#confirm-modal').modal('hide');
                    $('#success-modal').modal('show');
                    $('#success-modal').click(function (e) {
                        $('#success-modal').modal('toggle');
                        location.reload();
                    });
                    const myTimeout = setTimeout(myGreeting, 5000);
                 /*   console.log(data.update)
                    location.reload();*/
                }
            });
        })
    </script>
    <script>
        $(document).ready(function() {
            /*$("#reload1").click(function (){
                $("#step1Content").load('YourUrl');
            })
            $("#reload2").click(function (){
                $("#step1Content").load('YourUrl');
            })
            $("#reload3").click(function (){
                $("#step1Content").load('YourUrl');
            })*/
            let temp=0;
            $("#addImage1").click(function() {
                /*$("#modal-medial #selection option[value='file']").attr('selected', 'selected');*/
                temp=this.name;
                $.post("/admin/url-image",{url:temp},function (data,status){
                    if(data){
                        console("getlinksucess");

                    }
                });
            });
            });
            $("#addImage2").click(function() {
                temp=this.name;
                $.post("/admin/url-image",{url:temp},function (data,status){
                    if(data){
                        console("getlinksucess")
                    }
                });
            });
            $("#addImage3").click(function() {
                temp=this.name;
                $.post("/admin/url-image",{url:temp},function (data,status){
                    console.log(data);
                    if(data){
                        console("getlinksucess")
                    }
                });
            });
            $("#input-700").fileinput({
                overwriteInitial: false,
                validateInitialCount: true,
                initialPreviewAsData: true,
                previewFileType: "image",
                browseClass: "btn btn-success",
                browseLabel: "Chọn hình",
                browseIcon: "<i class=\"bi-file-image\"></i> ",
                removeClass: "btn btn-danger",
                removeLabel: "Xóa",
                removeIcon: "<i class=\"bi-trash\"></i> ",
                uploadClass: "btn btn-info",
                uploadLabel: "Upload hình",
                uploadIcon: "<i class=\"bi-upload\"></i> ",
                uploadUrl: "/admin/upload/{{list.pro_id}}",
                initialPreviewConfig: [
                    {caption: "People-1.jpg", description: 'This is a representative placeholder description for this image.', size: 576237, width: "120px", url: "/site/file-delete", key: 1},
                ],
                theme:'fa',
                language:'vi',
                allowedFileExtensions:['jpg'],
            }).on('fileuploaded', function(e, params) {
                console.log(params.response.filename)
                if(params.response.filename.includes("1")){
                    console.log(params.response.detail);
                    console.log("1");
                    $.ajax({
                        async:false,
                        type:"POST",
                        url:"/admin/geturl",
                        data:{url:params.response.detail,id:"image1"},
                        success:function (data){
                            $("#image1").replaceWith(data);
                        },
                        err:function (xhr,ajaxOptions,thrownError){
                            alert("Lỗi")
                        }
                    })
                }
                else if(params.response.filename.includes("2")){
                    console.log(params.response.detail);
                    console.log("2");
                    $.ajax({
                        async:false,
                        type:"POST",
                        url:"/admin/geturl",
                        data:{url:params.response.detail,id:"image2"},

                        success:function (data){
                            $("#image2").replaceWith(data)
                        },
                        err:function (xhr,ajaxOptions,thrownError){
                            alert("Lỗi")
                        },
                    })
                }
                else if(params.response.filename.includes("3")){
                    console.log(params.response.detail);
                    console.log("3");
                    $.ajax({
                        async:false,
                        type:"POST",
                        url:"/admin/geturl",
                        data:{url:params.response.detail,id:"image3"},
                        success:function (data){
                            $("#image3").replaceWith(data);
                            console.log(data);
                        },
                        err:function (xhr,ajaxOptions,thrownError){
                            alert("Lỗi")
                        }
                    })
                }
            });

    </script>
{{/section}}
